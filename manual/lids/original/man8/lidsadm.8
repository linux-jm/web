.TH LIDSADM 8
.\"
.\" Man page written by Sander Klein <roedie@roedie.nl> (May 2003)
.\" It is based on the original lidsadm page by Steve Bremer.
.\" TODO: I will think of something in the end...
.\"
.\"	This program is free software; you can redistribute it and/or modify
.\"     it under the terms of the GNU General Public License as published by
.\"     the Free Software Foundation; either version 2 of the License, or
.\"     (at your option) any later version.
.\"
.\"     This program is distributed in the hope that it will be useful,
.\"     but WITHOUT ANY WARRANTY; without even the implied warranty of
.\"     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\"     GNU General Public License for more details.
.\"
.\"     You should have received a copy of the GNU General Public License
.\"     along with this program; if not, write to the Free Software
.\"     Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
.\"
.\"

.SH NAME
lidsadm \- administration tool for the Linux Intrusion Detection System

.SH SYNOPSIS
.B "lidsadm -[S|I] -- [+|-][LIDS_FLAG] [...]"
.br
.B "lidsadm -V"
.br
.B "lidsadm -h"

.SH DESCRIPTION
.B lidsadm
is a adminsitration tool for
.I Linux Intrusion Detection System (LIDS).

LIDS is a kernel patch to enhance the current Linux kernel. With LIDS, you can protect important files, directories, and devices. You can also define ACLs that restrict the access control on the entire system. For more information about LIDS, please go to
.I http://www.lids.org.

.B lidsadm
is used to define ACLs and administer the LIDS protections online.

.SH COMMANDS
Commands define the individual functions of the lidsadm utility.  They cannot be combined.
.TP
.B -P
Encrypt a LIDS password with RipeMD-160 (stored in lids.pw).
.TP
.B -S
Change LIDS protections (requires your LIDS password).
.TP
.B -I
Changes LIDS protections once without a password (used only to "seal the kernel").
.TP
.B -V
Lets you view the current state of you LIDS system.
.TP
.B -v
Shows the version of the lidsadm.
.TP
.B -h
List the help.

.SH LIDS_FLAG's
.TP
There are many flags you can set. They can be used to set or unset capabilities but they can also switch you LIDS system on or off.

.SH Available capabilities
The capabilities used in LIDS are shown below. You can use the name to enable or disable the capability when sealing and switching. You can also grant the capability to a program even if the capability is disabled globally on the system.

.SP
.TP
.B CAP_CHOWN
chown(2)/chgrp(2)
.TP
.B    CAP_DAC_OVERRIDE
DAC access.
.TP
.B CAP_DAC_READ_SEARCH
DAC read.
.TP
.B          CAP_FOWNER
Owner ID not equal user ID.
.TP
.B          CAP_FSETID
Effective user ID not equal owner ID.
.TP
.B            CAP_KILL
Real/effective ID not equal process ID.
.TP
.B         CAP_SETGID
setgid(2)
.TP
.B          CAP_SETUID
set*uid(2)
.TP
.B         CAP_SETPCAP
Transfer capability.
.TP
.B  CAP_LINUX_IMMUTABLE
Immutable and append file attributes.
.TP
.B CAP_NET_BIND_SERVICE
Binding to ports below 1024.
.TP
.B   CAP_NET_BROADCAST
Broadcasting/listening to multicast.
.TP
.B       CAP_NET_ADMIN
Interface/firewall/routing changes.
.TP
.B         CAP_NET_RAW
Raw sockets (ping).
.TP
.B        CAP_IPC_LOCK
Locking of shared memory segments.
.TP
.B       CAP_IPC_OWNER
IPC ownership checks.
.TP
.B      CAP_SYS_MODULE
Insertion and removal of kernel modules.
.TP
.B       CAP_SYS_RAWIO
ioperm(2)/iopl(2) access
.TP
.B      CAP_SYS_CHROOT
chroot(2)
.TP
.B      CAP_SYS_PTRACE
ptrace(2)
.TP
.B       CAP_SYS_PACCT
Configuration of process accounting.
.TP
.B       CAP_SYS_ADMIN
Tons of admin stuff.
.TP
.B        CAP_SYS_BOOT
reboot(2)
.TP
.B        CAP_SYS_NICE
nice(2)
.TP
.B    CAP_SYS_RESOURCE
Setting resource limits.
.TP
.B        CAP_SYS_TIME
Setting system time.
.TP
.B  CAP_SYS_TTY_CONFIG
TTY configuration.
.TP
.B  CAP_MKNOD
Allow the privileged aspects of mknod().
.TP
.B  CAP_LEASE
Allow taking of leases on files.
.TP
.B  CAP_HIDDEN
Make a program hidden from the entire system.
.TP
.B  CAP_KILL_PROTECTED
Allow/disallow a process to kill protected processes.
.TP
.B  CAP_PROTECTED
Protect the process from signals.

.SH Available FLAGS

These flags are used with the ADMIN option "-S".
.TP
.B LIDS_GLOBAL
Enable/disable LIDS system-wide.
.TP
.B RELOAD_CONF
Reload config files and inode/dev numbers of special programs.
.TP
.B LIDS
Enable/disable LIDS locally (the shell & childs). This is known as a LIDS free session (LFS).

.SH EXAMPLES
Here are some examples of using lidsadm.
.TP
.B lidsadm -I
Seal the kernel with the default capabilities set in /etc/lids/lids.cap. You should edit that file by youself.
.TP
.B lidsadm -S -- -LIDS
Switch LIDS off in your current terminal session, we recomend you use this.
.TP
.B lidsadm -S -- -LIDS_GLOBAL
Switch LIDS off globally.  Your system is no longer protected by LIDS.

.SH OTHER SOURCES OF INFORMATION.
.TP 
.B Mailing List
To subscribe, unsubscribe, go to:
.I http://lists.sourceforge.net/lists/listinfo/lids-user
.br
To post a message to the list, send an e-mail to:
.B lids-user@lists.sourceforge.net
.br
Current LIDS archive can be found at:
.I http://www.geocrawler.com/redir-sf.php3?list=lids-user
.br
An outdated searchable archive can be found at:
.I http://groups.yahoo.com/group/lids

.TP 
.B LIDS FAQ
The LIDS FAQ is located at:
.br
.I http://www.lids.org/lids-faq.lids-faq.html
.br
or
.br
.I http://www.roedie.nl/lids-faq/

.SH BUGS 
Any bugs found with LIDS itself should be sent to Xie, Phil, or the mailing list
.B (lids-user@lists.sourceforge.net).
Please include your .config file used to compile your kernel, and the lids.conf and lids.cap files located in /etc/lids directory.  Any errors found in this man page should be sent to Sander Klein. 
.SH FILES
\fB/etc/lids/lids.conf\fR \- LIDS configuration file.
.br
\fB/etc/lids/lids.cap\fR \- Defines the global capabilities.
.br
\fB/etc/lids/lids.net\fR \- Configuration file for e-mail alerts.
.br
\fB/etc/lids/lids.pw\fR \- Contains the encrypted LIDS password.

.SH SEE ALSO
.BR lidsconf (8)

.SH AUTHORS
Huagang Xie
.I <xie@lids.org>
.PP
Philippe Biondi 
.I <biondi@cartel-securite.fr>
.PP
Manpage written by Sander Klein
.I <roedie@roedie.nl>

.SH DISTRIBUTION
The newest version of 
.I LIDS 
can be obtained from 
.I http://www.lids.org/ 
or the mirrors.
.Sp
.I LIDS 
is (C) 1999-2003 by Huagang Xie(xie@lids.org).
.\" See the lidsconf (8) man page for some funny remarks...
.\"

