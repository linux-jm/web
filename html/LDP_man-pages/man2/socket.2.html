
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of SOCKET</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../jm.css">
</HEAD>
<BODY>

<H1>SOCKET</H1>
Section: Linux Programmer's Manual (2)<BR>Updated: 2020-06-09<BR><A HREF="#index">Index</A>
<A HREF="../../../index.html">JM Home Page</A>
<A HREF="../../../manual/LDP_man-pages/release/man2/socket.2">roff page</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>名前</H2>

socket - 通信のための端点 (endpoint) を作成する
<A NAME="lbAC">&nbsp;</A>
<H2>書式</H2>

<B>#include &lt;<A HREF="file:///usr/include/sys/types.h">sys/types.h</A>&gt;</B> /* 「注意」参照 */
<BR>

<B>#include &lt;<A HREF="file:///usr/include/sys/socket.h">sys/socket.h</A>&gt;</B>
<P>

<B>int socket(int </B><I>domain</I><B>, int </B><I>type</I><B>, int </B><I>protocol</I><B>);</B>
<A NAME="lbAD">&nbsp;</A>
<H2>説明</H2>

<B>socket</B>()  creates an endpoint for communication and returns a file
descriptor that refers to that endpoint.  The file descriptor returned by a
successful call will be the lowest-numbered file descriptor not currently
open for the process.
<P>

<I>domain</I> 引数は通信を行なうドメインを指定する; これはどの プロトコルファミリー (protocol family)
を通信に使用するかを指定する。 これらのファミリーは <I>&lt;<A HREF="file:///usr/include/sys/socket.h">sys/socket.h</A>&gt;</I>
に定義されている。現在カーネルが理解できるフォーマットは以下の通り。
<TABLE>
<TR VALIGN=top><TD>名前&nbsp;</TD><TD>目的</TD><TD>マニュアル<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_UNIX</B>
&nbsp;</TD><TD>
ローカル通信
</TD><TD>
<B><A HREF="../man7/unix.7.html">unix</A></B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_LOCAL</B>
&nbsp;</TD><TD>
Synonym for
<B>AF_UNIX</B>
</TD><TD>
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_INET</B>
&nbsp;</TD><TD>IPv4 インターネットプロトコル</TD><TD>
<B><A HREF="../man7/ip.7.html">ip</A></B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_AX25</B>
&nbsp;</TD><TD>
アマチュア無線 AX.25 プロトコル
</TD><TD>

<B>ax25</B>(4)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_IPX</B>
&nbsp;</TD><TD>IPX - Novell プロトコル</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_APPLETALK</B>
&nbsp;</TD><TD>AppleTalk</TD><TD>
<B><A HREF="../man7/ddp.7.html">ddp</A></B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_X25</B>
&nbsp;</TD><TD>ITU-T X.25 / ISO-8208 プロトコル</TD><TD>
<B><A HREF="../man7/x25.7.html">x25</A></B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_INET6</B>
&nbsp;</TD><TD>IPv6 インターネットプロトコル</TD><TD>
<B><A HREF="../man7/ipv6.7.html">ipv6</A></B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_DECnet</B>
&nbsp;</TD><TD>
DECet protocol sockets
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_KEY</B>
&nbsp;</TD><TD>
Key management protocol, originally developed for usage with IPsec
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_NETLINK</B>
&nbsp;</TD><TD>
カーネルユーザーインターフェースデバイス
</TD><TD>
<B><A HREF="../man7/netlink.7.html">netlink</A></B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_PACKET</B>
&nbsp;</TD><TD>
低レベルのパケットインターフェース
</TD><TD>
<B><A HREF="../man7/packet.7.html">packet</A></B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_RDS</B>
&nbsp;</TD><TD>

Reliable Datagram Sockets (RDS) protocol
</TD><TD>


<B>rds</B>(7)
<BR>

<B>rds-rdma</B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_PPPOX</B>
&nbsp;</TD><TD>
Generic PPP transport layer, for setting up L2 tunnels
(L2TP and PPPoE)
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_LLC</B>
&nbsp;</TD><TD>

Logical link control (IEEE 802.2 LLC) protocol
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_IB</B>
&nbsp;</TD><TD>

InfiniBand native addressing
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_MPLS</B>
&nbsp;</TD><TD>

Multiprotocol Label Switching
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_CAN</B>
&nbsp;</TD><TD>

Controller Area Network automotive bus protocol
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_TIPC</B>
&nbsp;</TD><TD>

TIPC, &quot;cluster domain sockets&quot; protocol
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_BLUETOOTH</B>
&nbsp;</TD><TD>

Bluetooth low-level socket protocol
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_ALG</B>
&nbsp;</TD><TD>

カーネルの暗号 API へのインターフェース
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_VSOCK</B>
&nbsp;</TD><TD>

VSOCK (originally &quot;VMWare VSockets&quot;) protocol
for hypervisor-guest communication
</TD><TD>
<B>vsock</B>(7)
<BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_KCM</B>
&nbsp;</TD><TD>

KCM (kernel connection multiplexer) interface
</TD><TD><BR></TD></TR>
<TR VALIGN=top><TD>
<B>AF_XDP</B>
&nbsp;</TD><TD>

XDP (express data path) interface
</TD><TD><BR></TD></TR>
</TABLE>

<P>

Further details of the above address families, as well as information on
several other address families, can be found in <B>address_families</B>(7).
<P>

ソケットは <I>type</I> で指定される型を持ち、それは通信方式 (semantics) を指定する。 定義されている型は現在以下の通り。
<DL COMPACT>
<DT><B>SOCK_STREAM</B><DD>
順序性と信頼性があり、双方向の、接続された バイトストリーム (byte stream) を提供する。 帯域外 (out-of-band)
データ転送メカニズムもサポートされる。
<DT><B>SOCK_DGRAM</B><DD>
データグラム (コネクションレス、信頼性無し、固定最大長メッセージ) をサポートする。
<DT><B>SOCK_SEQPACKET</B><DD>
固定最大長のデータグラム転送パスに基づいた順序性、信頼性のある 双方向の接続に基づいた通信を提供する。受け取り側ではそれぞれの入力
システムコールでパケット全体を読み取ることが要求される。
<DT><B>SOCK_RAW</B><DD>
生のネットワークプロトコルへのアクセスを提供する。
<DT><B>SOCK_RDM</B><DD>
信頼性はあるが、順序は保証しないデータグラム層を提供する。
<DT><B>SOCK_PACKET</B><DD>
廃止されており新しいプログラムで使用してはいけない。 <B><A HREF="../man7/packet.7.html">packet</A></B>(7)  を参照すること
</DL>
<P>

ある種のソケット型が全てのプロトコルファミリーで実装されているわけではない。
<P>

Linux 2.6.27 以降では、 <I>type</I> 引数は二つ目の目的にも使用される。 ソケットの型を指定するのに加えて、
以下の値のいくつかをビット単位の論理和 (OR) で指定することで、 <B>socket</B>()  の振舞いを変更することができる。
<DL COMPACT>
<DT><B>SOCK_NONBLOCK</B><DD>
Set the <B>O_NONBLOCK</B> file status flag on the open file description (see
<B><A HREF="../man2/open.2.html">open</A></B>(2))  referred to by the new file descriptor.  Using this flag saves
extra calls to <B><A HREF="../man2/fcntl.2.html">fcntl</A></B>(2)  to achieve the same result.
<DT><B>SOCK_CLOEXEC</B><DD>
新しいファイルディスクリプターに対して close-on-exec (<B>FD_CLOEXEC</B>)  フラグをセットする。
このフラグが役に立つ理由については、 <B><A HREF="../man2/open.2.html">open</A></B>(2)  の <B>O_CLOEXEC</B> フラグの説明を参照のこと。
</DL>
<P>

<I>protocol</I> はソケットによって使用される固有のプロトコルを指定する。通常それぞれの
ソケットは、与えられたプロトコルファミリーの種類ごとに一つのプロトコルのみを サポートする。 その場合は <I>protocol</I> に 0 を指定できる。
しかし、多くのプロトコルが存在してもかまわない。 この場合にはこの方法により固有のプロトコルを指定する必要がある。
使用されるプロトコル番号は通信の行なわれる``通信ドメイン''に 固有である; <B><A HREF="../man5/protocols.5.html">protocols</A></B>(5)  を参照すること。
プロトコル名をどうやってプロトコル番号に対応させるかについては <B><A HREF="../man3/getprotoent.3.html">getprotoent</A></B>(3)  を参照すること。
<P>

<B>SOCK_STREAM</B> 型のソケットは全二重バイトストリームである。 これらはレコード境界を保存しない。
ストリームは、ソケットがデータを送ったり受けたりする前に <I>接続された</I> 状態になってなければならない。他のソケットへの接続は
<B><A HREF="../man2/connect.2.html">connect</A></B>(2)  コールによって行なわれる。一度接続したらデータは <B><A HREF="../man2/read.2.html">read</A></B>(2)  と <B><A HREF="../man2/write.2.html">write</A></B>(2)  コールや
<B><A HREF="../man2/send.2.html">send</A></B>(2)  と <B><A HREF="../man2/recv.2.html">recv</A></B>(2)  コールの変種を使用して転送できる。 セッションが完了したら <B><A HREF="../man2/close.2.html">close</A></B>(2)
が行なわれる。帯域外データの転送も <B><A HREF="../man2/send.2.html">send</A></B>(2)  に記述されており、 受信も <B><A HREF="../man2/recv.2.html">recv</A></B>(2)  に記述されている。
<P>

<B>SOCK_STREAM</B> を実装した通信プロトコルはデータに損失や重複がないことを保証する。 もし相手のプロトコルがバッファー空間を持つ
データの断片を適当な時間のうちに転送できなければ、 接続は断たれたとみなす。そのソケット <B>SO_KEEPALIVE</B>
が有効になっている場合、プロトコル独自の方法で接続の相手側がまだ 有効であるかをチェックする。
もしプロセスが、壊れたストリームでデータを送受信しようとした場合には <B>SIGPIPE</B> シグナルが送られる;
これは通常のそのシグナルを扱っていないプロセスを 終了させる。 <B>SOCK_SEQPACKET</B> ソケットは <B>SOCK_STREAM</B>
ソケットと同じシステムコールを使用する。 唯一の違いは <B><A HREF="../man2/read.2.html">read</A></B>(2)  コールが要求された量のデータのみを返し、到着したパケットの残りの部分を
捨ててしまうことである。同様に入ってくるデータグラムの全てのメッセージ境界は 保存される。
<P>

<B>SOCK_DGRAM</B> と <B>SOCK_RAW</B> ソケットは <B><A HREF="../man2/sendto.2.html">sendto</A></B>(2)
コールで指定された相手へデータグラムを送ることが許されている。 データグラムは一般に <B><A HREF="../man2/recvfrom.2.html">recvfrom</A></B>(2)  で受けとり、
このコールは次のデータグラムを送信者のアドレスと一緒に返す。
<P>

<B>SOCK_PACKET</B> は古いソケット型で、生(raw)のパケットをデバイスドライバから 直接受信するためのものである。 今は代わりに
<B><A HREF="../man7/packet.7.html">packet</A></B>(7)  を用いること。
<P>

<B><A HREF="../man2/fcntl.2.html">fcntl</A></B>(2)  の <B>F_SETOWN</B> 操作を使って、シグナル <B>SIGURG</B> や <B>SIGPIPE</B>
を受けとるプロセスグループを指定できる。 <B>SIGURG</B> シグナルは帯域外データが到着した時に、 <B>SIGPIPE</B> シグナルは
<B>SOCK_STREAM</B> 接続が予期せず切断された時に送られる。 また、 <B>F_SETOWN</B> 操作は、I/O や I/O イベントの非同期
(asynchronous) 通知を <B>SIGIO</B> を経由で受け取るプロセスやプロセスグループを設定するのにも使用できる。 <B>F_SETOWN</B>
を使用することは <B>FIOSETOWN</B> または <B>SIOCSPGRP</B> の引数で <B><A HREF="../man2/ioctl.2.html">ioctl</A></B>(2)  を使用することと等価である。
<P>

ネットワークがプロトコルモジュールにエラー状態を伝えた場合 (例えば、IP の ICMP メッセージを使用して)には、ソケットの
ペンディングエラーフラグが設定される。次にこのソケットを操作した 時にペンディングされていたエラーコードが返される。プロトコルによっては
エラーについてのより詳しい情報を受け取るためにソケットごとのエラーキューを 受け取ることが可能である。 <B><A HREF="../man7/ip.7.html">ip</A></B>(7)  の
<B>IP_RECVERR</B> を参照すること。
<P>

ソケットの操作はソケットレベル <I>options</I> によって制御される。 これらのオプションは <I>&lt;<A HREF="file:///usr/include/sys/socket.h">sys/socket.h</A>&gt;</I>
に定義されている。 <B><A HREF="../man2/setsockopt.2.html">setsockopt</A></B>(2)  と <B><A HREF="../man2/getsockopt.2.html">getsockopt</A></B>(2)  関数はそれぞれオプションの設定と取得を行なう。
<A NAME="lbAE">&nbsp;</A>
<H2>返り値</H2>

成功した場合、新しいソケットのファイルディスクリプターを返す。 エラーが発生した場合は -1 を返し、 <I>errno</I> を適切に設定する。
<A NAME="lbAF">&nbsp;</A>
<H2>エラー</H2>

<DL COMPACT>
<DT><B>EACCES</B><DD>
指定されたタイプまたはプロトコルのソケットを作成する許可が与えられていない。
<DT><B>EAFNOSUPPORT</B><DD>
指定されたアドレスファミリーがサポートされていない。
<DT><B>EINVAL</B><DD>
知らないプロトコル、または利用できないプロトコルファミリーである。
<DT><B>EINVAL</B><DD>

<I>type</I> に無効なフラグが指定されている。
<DT><B>EMFILE</B><DD>
1プロセスがオープンできるファイルディスクリプター数の上限に達した。
<DT><B>ENFILE</B><DD>
オープンされたファイルの総数がシステム全体の上限に達していた。
<DT><B>ENOBUFS</B> または <B>ENOMEM</B><DD>
十分なメモリーがない。十分な資源が解放されるまではソケットを 作成することはできない。
<DT><B>EPROTONOSUPPORT</B><DD>
このドメインでは指定されたプロトコルまたはプロトコルタイプが サポートされていない。
</DL>
<P>

下位のプロトコルモジュールから他のエラーが生成されるかもしれない。
<A NAME="lbAG">&nbsp;</A>
<H2>準拠</H2>

POSIX.1-2001, POSIX.1-2008, 4.4BSD.
<P>

フラグ <B>SOCK_NONBLOCK</B>, <B>SOCK_CLOEXEC</B> は Linux 固有である。
<P>

<B>socket</B>()  は 4.2BSD で登場した。一般に、(System&nbsp;V の変種を含めて)  BSD のソケット層の互換性をサポートしている
BSD 以外のシステムへの、 または、BSD 以外のシステムからの移植ができる。
<A NAME="lbAH">&nbsp;</A>
<H2>注意</H2>

POSIX.1 では <I>&lt;<A HREF="file:///usr/include/sys/types.h">sys/types.h</A>&gt;</I> のインクルードは必須とされておらず、 Linux
ではこのヘッダーファイルは必要ではない。 しかし、歴史的には、いくつかの実装 (BSD 系) でこのヘッダーファイルが
必要であり、移植性が必要なアプリケーションではこのファイルを インクルードするのが賢明であろう。
<P>

4.x BSD において定数を使用する場合、プロトコルファミリーには
<B>PF_UNIX</B>, <B>PF_INET</B> 等を使用している。一方でアドレスファミリーには
<B>AF_UNIX</B>, <B>AF_INET</B> 等が使用されている。
しかしながら BSD のマニュアルでは 「一般にプロトコルファミリーは
アドレスファミリーと同じものである。」 と保証している。
それ以外の規格では全ての場所で AF_* が使用されている。
<A NAME="lbAI">&nbsp;</A>
<H2>例</H2>

<B>socket</B>()  の利用例が <B><A HREF="../man3/getaddrinfo.3.html">getaddrinfo</A></B>(3)  に記載されている。
<A NAME="lbAJ">&nbsp;</A>
<H2>関連項目</H2>

<B><A HREF="../man2/accept.2.html">accept</A></B>(2), <B><A HREF="../man2/bind.2.html">bind</A></B>(2), <B><A HREF="../man2/close.2.html">close</A></B>(2), <B><A HREF="../man2/connect.2.html">connect</A></B>(2), <B><A HREF="../man2/fcntl.2.html">fcntl</A></B>(2),
<B><A HREF="../man2/getpeername.2.html">getpeername</A></B>(2), <B><A HREF="../man2/getsockname.2.html">getsockname</A></B>(2), <B><A HREF="../man2/getsockopt.2.html">getsockopt</A></B>(2), <B><A HREF="../man2/ioctl.2.html">ioctl</A></B>(2),
<B><A HREF="../man2/listen.2.html">listen</A></B>(2), <B><A HREF="../man2/read.2.html">read</A></B>(2), <B><A HREF="../man2/recv.2.html">recv</A></B>(2), <B><A HREF="../man2/select.2.html">select</A></B>(2), <B><A HREF="../man2/send.2.html">send</A></B>(2),
<B><A HREF="../man2/shutdown.2.html">shutdown</A></B>(2), <B><A HREF="../man2/socketpair.2.html">socketpair</A></B>(2), <B><A HREF="../man2/write.2.html">write</A></B>(2), <B><A HREF="../man3/getprotoent.3.html">getprotoent</A></B>(3),
<B>address_families</B>(7), <B><A HREF="../man7/ip.7.html">ip</A></B>(7), <B><A HREF="../man7/socket.7.html">socket</A></B>(7), <B><A HREF="../man7/tcp.7.html">tcp</A></B>(7), <B><A HREF="../man7/udp.7.html">udp</A></B>(7),
<B><A HREF="../man7/unix.7.html">unix</A></B>(7)
<P>

"An Introductory 4.3BSD Interprocess Communication Tutorial" and
"BSD Interprocess Communication Tutorial", (<I>UNIX Programmer's
Supplementary Documents Volume 1.</I> として再版された)
<A NAME="lbAK">&nbsp;</A>
<H2>この文書について</H2>

この man ページは Linux <I>man-pages</I> プロジェクトのリリース 5.10 の一部である。プロジェクトの説明とバグ報告に関する情報は
<A HREF="https://www.kernel.org/doc/man-pages/">https://www.kernel.org/doc/man-pages/</A> に書かれている。
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">名前</A><DD>
<DT><A HREF="#lbAC">書式</A><DD>
<DT><A HREF="#lbAD">説明</A><DD>
<DT><A HREF="#lbAE">返り値</A><DD>
<DT><A HREF="#lbAF">エラー</A><DD>
<DT><A HREF="#lbAG">準拠</A><DD>
<DT><A HREF="#lbAH">注意</A><DD>
<DT><A HREF="#lbAI">例</A><DD>
<DT><A HREF="#lbAJ">関連項目</A><DD>
<DT><A HREF="#lbAK">この文書について</A><DD>
</DL>
<HR>
This document was created by
<A HREF="../../man/man1/man2html.1.html">man2html</A>,
using the manual pages.<BR>
Time: 03:33:34 GMT, December 05, 2022
</BODY>
</HTML>
