
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of ROUTED</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../jm.css">
</HEAD>
<BODY>

<H1>ROUTED</H1>
Section: Maintenance Commands (8)<BR><A HREF="#index">Index</A>
<A HREF="../../../index.html">JM Home Page</A>
<A HREF="../../../manual/netkit/release/man8/routed.8">roff page</A><HR>
<BR>BSD mandoc<BR>
Linux NetKit (0.17)

<A NAME="lbAB">&nbsp;</A>
<H2>名前</H2>

<B>routed</B>

 - ネットワークルーティングデーモン

<A NAME="lbAC">&nbsp;</A>
<H2>書式</H2>

<B>routed</B>

[-<B>d</B>

]

[-<B>g</B>

]

[-<B>q</B>

]

[-<B>s</B>

]

[-<B>t</B>

]

[<I>logfile</I>

]

<A NAME="lbAD">&nbsp;</A>
<H2>説明</H2>

<B>routed</B>

は、ネットワークのルーティングテーブルを管理するために、ブート時に起動される。
ルーティングデーモンは、
Xerox NS ルーティング情報プロトコル
(Routing Information Protocol) を変更したものを使う。
これにより、カーネルのルーティングテーブルのエントリを最新に保つ。
このサーバは、複数のアドレスタイプを使用できる一般化したプロトコルを使う。
しかし、現在のところは、ネットワーククラスタ内で
インターネットのルーティングをするためだけに使われている。
<P>

通常の運用において
<B>routed</B>

は、
ルーティング情報パケットを待つために、
<A HREF="../../net-tools/man8/route.8.html">route</A>(8)


サービス
<B>( <A HREF="../../LDP_man-pages/man5/services.5.html">services</A>(5)

</B>

を参照)
用の
udp(4)


ソケットの接続を待つ。
ホストがネットワーク間のルータである場合、
<B>routed</B>

は、直接接続されている全てのホストとネットワークに、
ルーティングテーブルの複製を定期的に提供する。
<P>

<B>routed</B>

が動作し始めると、
システムで設定されており、
かつ ``up'' とマークされている
直接接続されたインターフェースを探すために、
<B>SIOCGIFCONF</B>

<A HREF="../../LDP_man-pages/man2/ioctl.2.html">ioctl</A>(2)


が使われる (ソフトウェアループバックインターフェースは無視される)。
複数のインターフェースが存在する場合、
ホストはネットワーク間でパケットを転送するものと仮定される。
それから
<B>routed</B>

は、
<I>リクエスト</I>

パケットを各インターフェースから送信する
(インターフェースがサポートしている場合は、ブロードキャストパケットを使う)。
そして、
<B>routed</B>

は、他のホストからの
<I>リクエスト</I>

パケットと
<I>レスポンス</I>

パケットの接続を待つループに入る。
<P>

<I>リクエスト</I>

パケットを受信すると、
<B>routed</B>

は内部テーブルで管理している情報に基づいてリプライを作成する。
作成された
<I>レスポンス</I>

パケットには既知のルートのリストが含まれ、
各ルートには「ホップカウント」メトリックが付く
(16 以上のホップカウントは「無限大」とみなされる)。
ここで返された各ルートのメトリックは、
<I>送信者からの相対的な</I>

メトリックである。
<P>

以下の条件を満たす場合、
<B>routed</B>

が受信した
<I>レスポンス</I>

パケットは、
ルーティングテーブルを更新するために使われる:
<OL><P>

<LI>

到達先ネットワークまたは到達先ホストについての
ルーティングテーブルのエントリが存在せず、
かつ到達先を示すメトリックが「到達可能」である場合
(すなわち、ホップカウントが無限大でない場合)。
<LI>

パケットの送信元ホストが、
既存のルーティングテーブルのエントリにあるネットワーク間ルータと同じ場合。
つまり、到達先へのパケットをルーティングする
ルータそのものから、更新された情報を受け取る場合。
<LI>

ルーティングテーブルの既存のエントリが
一定期間 (90 秒と定義されている) 更新されておらず、
このルートが少なくとも現在のルートと同じくらい有効な価値がある場合。
<LI>

新しいルートが、現在ルーティングテーブルに格納されているルートと比べて、
到達先へのより短いルートを表している場合。
これを決定するために、新しいルートのメトリックを
テーブルに格納されているルートのメトリックと比較する。
</OL><P>

<P>

更新が行われた場合、
<B>routed</B>

は内部テーブルの変更を記録し、カーネルのルーティングテーブルを更新する。
この変更は次に
<I>レスポンス</I>

パケットを送信する際に反映される。
<P>

<B>routed</B>

は外部からのパケットを処理するのに加え、
定期的にルーティングテーブルのエントリをチェックする。
エントリが 3 分間以上更新されていない場合、
そのエントリのメトリックは無限大に設定され、
削除のためのマークが付けられる。
そのエントリの失効が
ローカルのインターネット上で通知されるのを保証するために、
削除は更に 60 秒後になる。
<P>

ネットワーク間ルータとして動作しているホストは、
直接接続された全てのホストやネットワークに対して、
30 秒毎に無条件でルーティングテーブルを提供する。
レスポンスは、
ブロードキャスト機能を持つネットワークのブロードキャストアドレス・
point-to-point リンクの到達先アドレス・
ルータ自身の他のネットワークでのアドレス
に対して送信される。
無条件にレスポンスを送信する場合、
通常のルーティングテーブルは無視される。
ネットワークとインターフェースが正しく機能しているかを、
各ネットワークがレスポンスを受信できるか否かを使って決定する。
あるインターフェースでレスポンスが受信できない場合、
そのインターフェースに対してルーティングするために別のルートを選択する。
また、他のルートもない場合、そのルートはルーティングテーブルから削除される。
<P>

<B>routed</B>

がサポートするオプションを示す:
<DL COMPACT>
<P>

<DT><B>-d</B>


<DD>
不正なパケットを受信したというような、
付加的なデバッグ情報をログに記録するようにする。
<DT><B>-g</B>


<DD>
このフラグは、ネットワーク間ルータにおいて 
``default'' の到達先へのルートを設けるために使われる。
このフラグは、インターネットのゲートウェイや、
他のローカルルータにルートを報告しない
別のルーティングプロトコルを利用するゲートウェイで、
典型的に使われる。
<DT><B>-s</B>


<DD>
このオプションを指定すると、
ネットワーク間ルータとして動作しているか否かに関係なく、
<B>routed</B>

に強制的にルーティング情報を提供させる。
複数のネットワークインターフェースがある場合や、
point-to-point リンクを使用中である場合は、これがデフォルトである。
<DT><B>-q</B>


<DD>
このオプションは、
-<B>s</B>

オプションの反対である。
<DT><B>-t</B>


<DD>
-<B>t</B>

オプションが指定すると、
送受信した全てのパケットが標準出力に表示される。
更に、
<B>routed</B>

は自分自身を制御端末から切り離さないため、
キーボードからインタラプトを入力すればプロセスが kill される。
</DL>
<P>

<P>

この他に指定された引き数は、
<B>routed</B>

の動作を記録するファイルの名前として解釈される。
このログにはルーティングテーブルの変更が記録される。
また、全てのパケットを追跡しない場合は、
変更されたルートに関連して送受信された最新のメッセージの履歴も記録される。
<P>

上記の機能に加えて、
<B>routed</B>

は「遠隔にある」
<I>passive</I>

もしくは
<I>active</I>

なゲートウェイという概念をサポートする。
<B>routed</B>

が起動すると、
<B>SIOGIFCONF</B>

<A HREF="../../LDP_man-pages/man2/ioctl.2.html">ioctl</A>(2)


からの情報のみでは突き止められない可能性のあるゲートウェイを見付けるために、
/etc/gateways

ファイルが読み込まれる。
このようにして指定したゲートウェイには、
ルーティング情報を交換するつもりがない場合には、
passive というマークを付ける必要がある。
また、ルーティング情報を交換する場合には、
active というマークを付ける必要がある
(すなわち、この場合には
<B>routed</B>

がマシン上で稼働している必要がある)。
passive ゲートウェイを通るルートは、
起動時に一度だけカーネルのルーティングテーブルに設定される。
このようなルートは、送信されるルーティング情報には含まれない。
active ゲートウェイは、ネットワークインターフェースと同様に扱われる。
ルーティング情報はゲートウェイに配布される。
また、一定時間ルーティング情報が受信されない場合、
それに関連したルートは削除される。
<I>external</I>

とマークされたゲートウェイも passive であるが、
カーネルのルーティングテーブルに載ることもなく、
ルーティングの更新時にもその情報が含められることはない。
external エントリの機能は、
<B>routed</B>

に対して、
「別のルーティングプロセスがそのようなルートを追加する可能性があり、
その到達先に対して他のルートを設定すべきでない」
と知らせることである。
external エントリは、
2 つのルータが同じ到達先へのルートを覚えてもよい場合にのみ、必要である。
<P>

/etc/gateways

は、以下のフォーマットの行で構成される:


&lt; <B>net |</B>





<B>host &gt;</B>



<I>name1</I>

<B>gateway</B>

<I>name2</I>

<B>metric</B>

<I>value</I>

&lt; <B>passive |</B>





<B>active |</B>



<B>external &gt;</B>




<P>

キーワード
<B>net</B>

と
<B>host</B>

はそれぞれ、ルートがネットワークに付いてのルートなのか、
特定のホストについてのルートなのかを示す。
<P>

<I>name1</I>

は、到達先ネットワークまたはホストの名前である。
この名前は、
/etc/networks

または
/etc/hosts

にあるシンボル名でもよい
(また、
<B>routed</B>

が
<A HREF="../../bind/man8/named.8.html">named</A>(8)


の後に起動される場合は、
ネームサーバがこの名前を知っていなければならない)。
また、
「ドット」表記で指定したインターネットアドレスでもよい。
<A HREF="../../LDP_man-pages/man3/inet.3.html">inet</A>(3)


を参照すること。
<P>

<I>name2</I>

は、メッセージがフォワードされるべきゲートウェイの名前またはアドレスである。
<P>

<I>value</I>

は、到達先ホストまたはネットワークへのホップカウントを表すメトリックである。
<P>

キーワード
<B>passive</B>

 
<B>active</B>

 
<B>external</B>

の 1 つを使って、
ゲートウェイが
<I>passive</I>

または
<I>active</I>

として (上記のように) 扱われる必要があるか、
あるいはゲートウェイが
<B>routed</B>

プロトコルのスコープで
<I>external</I>

であるのかを示す。
<P>

Arpanet や Milnet に直接接続されたネットワーク間ルータは、
ルーティング情報を集めるために
(<B>EGP</B>

)

を使うべきである。
さもなければ、passive ゲートウェイの静的ルーティングテーブルを使うことになる。
<B>EGP</B>

は、ローカルネットワークに対して
他のインターネットシステムへのルートを提供するために必要である。
<A NAME="lbAE">&nbsp;</A>
<H2>ファイル</H2>

<DL COMPACT>
<P>

<DT><B>/etc/gateways

</B>
<DD>
遠隔ゲートウェイについての情報を記述するファイル
</DL>
<P>

<A NAME="lbAF">&nbsp;</A>
<H2>関連項目</H2>

<A HREF="../../LDP_man-pages/man7/udp.7.html">udp</A>(7),


<A HREF="../../LDP_man-pages/man7/icmp.7.html">icmp</A>(7)


<DL COMPACT><DT><DD>
<I>Internet Transport Protocols</I>
<I>XSIS 028112</I>
Xerox System Integration Standard
</DL>

<A NAME="lbAG">&nbsp;</A>
<H2>バグ</H2>

<B>routed</B>

は (動作などが) 疑わしい。
gated(8)


または
zebra(8)


の使用を考慮に入れること。
<P>

リダイレクトによりルートが変更または追加された場合、
カーネルのルーティングテーブルと
<B>routed</B>

のルーティングテーブルが対応しない可能性がある。
<B>routed</B>

は、
raw ソケット経由で受信した
<B>ICMP</B>

パケットを読み込むことにより、
受信したリダイレクトを注目すべきである。
<P>

<B>routed</B>

は他のルーティングプロトコルも組み込むべきである。
各プロトコルに対して別々のプロセスを使うには、
余計なルートや競合するルートを排除するために、設定オプションが必要である。
<P>

<B>routed</B>

は、より多くの情報を集めるために、
<B>IMP</B>

のようなインテリジェントなインタフェースで接続を待つべきである。
<B>routed</B>

は、(例えば、出力側の失敗といった)
ネットワークインターフェースの
一方向の失敗を、常に検出できるとは限らない。
<A NAME="lbAH">&nbsp;</A>
<H2>履歴</H2>

<B></B>


コマンドは
BSD 4.2
で登場した。
<A NAME="lbAI">&nbsp;</A>
<H2>翻訳者謝辞</H2>

この man ページの翻訳にあたり、
FreeBSD jpman project &lt;<A HREF="http://www.jp.freebsd.org/man-jp/">http://www.jp.freebsd.org/man-jp/</A>&gt;
による翻訳を参考にさせていただいた。
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">名前</A><DD>
<DT><A HREF="#lbAC">書式</A><DD>
<DT><A HREF="#lbAD">説明</A><DD>
<DT><A HREF="#lbAE">ファイル</A><DD>
<DT><A HREF="#lbAF">関連項目</A><DD>
<DT><A HREF="#lbAG">バグ</A><DD>
<DT><A HREF="#lbAH">履歴</A><DD>
<DT><A HREF="#lbAI">翻訳者謝辞</A><DD>
</DL>
<HR>
This document was created by
<A HREF="../../man/man1/man2html.1.html">man2html</A>,
using the manual pages.<BR>
Time: 03:33:41 GMT, December 05, 2022
</BODY>
</HTML>
