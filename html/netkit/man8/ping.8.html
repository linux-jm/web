
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of PING</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../jm.css">
</HEAD>
<BODY>

<H1>PING</H1>
Section: Maintenance Commands (8)<BR><A HREF="#index">Index</A>
<A HREF="../../../index.html">JM Home Page</A>
<A HREF="../../../manual/netkit/release/man8/ping.8">roff page</A><HR>
<BR>BSD mandoc<BR>
Linux NetKit (0.17)

<A NAME="lbAB">&nbsp;</A>
<H2>名前</H2>

<B>ping</B>

 - <B>ICMP ECHO_REQUEST</B>



パケットをネットワーク上のホストに送る
<A NAME="lbAC">&nbsp;</A>
<H2>書式</H2>

<B>ping</B>

[-<B>LRdfnqrv</B>

]

[-<B>c </B><I>count</I>



]

[-<B>i </B><I>wait</I>



]

[-<B>l </B><I>preload</I>



]

[-<B>p </B><I>pattern</I>



]

[-<B>s </B><I>packetsize</I>



]

[-<B>t </B><I>ttl</I>



]

[-<B>w </B><I>waittime</I>



]

[-<B>I </B><I>interface address</I>



]

<A NAME="lbAD">&nbsp;</A>
<H2>説明</H2>

<B>ping</B>

は
<B>ICMP</B>

の
<B>ECHO_REQUEST</B>

データグラムを用いて、指定したホストやゲートウェイからの
<B>ICMP ECHO_RESPONSE</B>

を引き出す。
<B>ECHO_REQUEST</B>

データグラム (``pings'') は IP と
<B>ICMP</B>

ヘッダを持ち、それに
``struct timeval''

が続き、そして、パケットの残りを埋めるために任意個の ``pad'' バイトがある。
オプションは以下の通り:
その他のオプションは:
<DL COMPACT>
<P>

<DT><B>-c </B><I>count</I>




<DD>
<I>count</I>

個のパケットを送った (そしてその応答を受け取った) 後、停止する。
パケットが送られた後、
<B>ping</B>

は応答を受け取るまで 10 秒間待ち、終了する。
<DT><B>-d</B>


<DD>
使用するソケットに
<B>SO_DEBUG</B>

オプションを設定する。
<DT><B>-f</B>


<DD>
flood ping (ping の洪水)。パケットが戻ってくるとすぐ、
もしくは、1 秒間に 100 回の、いずれか多い回数だけパケットを送る。
<B>ECHO_REQUEST</B>

が送られるたびにピリオド ``.'' が表示され、
<B>ECHO_REPLY</B>

を受け取るごとに、バックスペースが表示される
(訳注: すなわち ``.'' が消去される)。
これにより、どのくらいのパケットが取りこぼされるかを、
すばやく表示することができる。スーパーユーザーだけがこのオプションを使える。
Bf -emphasis

これは、ネットワークに非常に負荷をかけるので、注意して使うべきである。
Ef <DT><B>-i </B><I>wait</I>




<DD>


個々のパケットの間に
<I>wait</I>

秒待つ。
デフォルトでは、個々のパケットの間に 1 秒待つ。このオプションは
-<B>f</B>

オプションとは同時に指定できない。
<DT><B>-l </B><I>preload</I>




<DD>
指定した
<I>preload</I>

の値だけ
<B>ECHO_REQUEST</B>

パケットを出来るだけ速く送信し、通常の動作に戻る。
スーパーユーザーだけがこのオプションを使用できる。
<DT><B>-n</B>


<DD>
数値出力のみ。
ホストのアドレスから、ホスト名の検索を試みない。
<DT><B>-p </B><I>pattern</I>




<DD>
送出するパケットを埋めるための 16 個までの ``pad'' バイトを指定できる。
これはネットワークでの、データに依存した問題の診断に有用である。
たとえば
``<B>-p ff</B>

''

は全て 1 で埋められたパケットを送る。
<DT><B>-q</B>


<DD>
静かな出力。
開始と終了時の要約以外は、何も表示しない。
<DT><B>-R</B>


<DD>
経路を記録。
<B>ECHO_REQUEST</B>

パケットに
<B>RECORD_ROUTE</B>

オプションを設定し、返ってきたパケットの経路バッファ
(route buffer) を表示する。
IP ヘッダは 9 つの経路分の大きさしかないことに注意せよ。
また、多くのホストはこのオプションを無視するか、破棄してしまう。
<DT><B>-r</B>


<DD>
通常のルーティングを無視し、接続されたネットワークのホストに直接送る。
もし、ホストが直に接続されたネットワークになければ、エラーが返る。
経路情報を持たないインタフェースを通して、
ローカルなホストへと ping するのに使われる。(例えば、インタフェースが
<A HREF="../man8/routed.8.html">routed</A>(8)


に落された場合)。
<DT><B>-s </B><I>packetsize</I>




<DD>
何バイトのデータが送られるかを指定する。デフォルトは 56 で、
<B>ICMP</B>

ヘッダの 8 バイトを加えて、
64 バイトの
<B>ICMP</B>

データになる。
スーパーユーザーだけがこのオプションを使用できる。
<DT><B>-v</B>


<DD>
詳細な出力。
受け取った
<B>ECHO_RESPONSE</B>

以外の
<B>ICMP</B>

パケットを表示する。
<DT><B>-w </B><I>waittime</I>




<DD>
どのような場合でも関係なく、
<B>ping</B>

を
<I>waittime</I>

秒後に終了させる。
</DL>
<P>

<P>

以下のオプションに関する記述は、
<B></B>


のソース、ならびに FreeBSD の man ページを参考に
日本語訳に際して追加された。
<DL COMPACT>
<P>

<DT><B>-I </B><I>interface</I>




<DD>
与えられたインタフェースから、マルチキャストパケットを送る。
<DT><B>-L</B>


<DD>
マルチキャストパケットのループバックを抑制する。
<DT><B>-t </B><I>ttl</I>




<DD>
マルチキャストパケットの IP 寿命時間 (Time To Live) を設定する。
</DL>
<P>

<P>

問題の切り分けのために
<B>ping</B>

を用いる場合、そのネットワークインタフェースが up かつ running である
ことを確認するために、まずローカルホスト上で実行するべきである。
その後により遠くのホストやゲートウェイに
``ping''

する。
往復時間 (round-trip time) と消失パケットの統計が計算される。
重複した応答メッセージを受け取った場合、
それらはパケットの損失の計算には使われないが、
それにもかかわらずそうしたパケットの往復時間は、
その最小値・平均値・最大値の計算に用いられる。
指定した数のパケットが送られた (そしてその応答を受け取った) か、プログラムが
<B>SIGINT</B>

で終了させられた場合は、簡単な要約が表示される。
<P>

もし
<B>ping</B>

が全く応答パケットを受け取らなかった場合には、終了コード 1 で終了する。
エラーがあればコード 2 で終了する。それ以外の場合はコード 0 で終了する。
これにより、終了コードで、あるホストが動いているかどうかを判断すること
ができる。
<P>

このプログラムはネットワークのテスト・計測・管理についての使用を意図している。
このプログラムがネットワークに強いる負荷を考えれば、
<B>ping</B>

をトラブルのないときや自動スクリプトから実行することは奨められない。
<A NAME="lbAE">&nbsp;</A>
<H2>ICMP パケットの詳細</H2>

オプションなしの IP ヘッダは 20 バイトである。
<B>ICMP</B>

<B>ECHO_REQUEST</B>

パケットは、さらなる 8 バイトの
<B>ICMP</B>

ヘッダとそれに続く任意の量のデータからなる。
<I>packetsize</I>

が与えられた時には、それは付加的なデータ部分のサイズ (デフォルトは 56) を示す。
よって
<B>ICMP</B>

<B>ECHO_REPLY</B>

パケットの IP パケット内で受け取るデータの量は、
要求されたデータ領域より 8 バイト
<B>( ICMP</B>



ヘッダの分) 多い。
<P>

もしデータ領域が 8 バイトよりも大きければ、
<B>ping</B>

はその領域の先頭 8 バイトを、往復時間を計算するのに使うタイムスタンプを
含めるために使用する。
もし 8 バイトよりも少なければ、往復時間は得られない。
<A NAME="lbAF">&nbsp;</A>
<H2>重複パケットと障害パケット</H2>

<B>ping</B>

は、重複パケットと障害パケットについて報告する。
重複パケットは (ユニキャストアドレスに対しては) 起きるはずはないが、
不適切なリンク層での再送によって引き起こされるように思われる。
重複は様々な状況で起こる可能性がある。低いレベルの重複の存在は
必ずしも警告にはならないかもしれないが、よい兆候ではない。
<P>

障害を受けたパケットは、明らかに深刻な警告であり、多くの場合
<B>ping</B>

パケットの経路上 (ネットワーク内、もしくはそのホスト内) のどこかに
壊れたハードウェアがあることを示す。
<A NAME="lbAG">&nbsp;</A>
<H2>異なるデータパターンの試行</H2>

(インター) ネットワーク層は、決してデータ部分に含まれるデータによって
パケットの扱いを変えたりしない。
不幸にも、データに依存した問題がネットワークへと侵入し、
長い時間発見されないままとなってしまう可能性が知られている。
問題のあるパケットの特定のパターンは多くの場合、
全てが 0 または全てが 1 のようなもの、
あるいは右端以外が殆んど 0 のような、
十分な ``遷移 (transitions)'' を持たないものである。
コマンドラインで (例えば) 全て 0 というデータパターンを指定することは、
必ずしも十分ではない。
なぜならば、その関心のあるのはデータリンク層におけるパターンであり、
あなたが入力したものと、コントローラーが送信するものとの関係は
複雑だからである。
<P>

これは、もしあなたがデータ依存性の問題を抱えているなら、
それを発見するためには
何回ものテストをしなければならないかもしれないことを意味する。
もし運が良ければ、ネットワークを通して送ることのできないファイルか、
同じような長さのファイルより、転送にずっと時間のかかるファイルを
発見することができるかもしれない。
そうしたら、そのファイルを調べ繰り返し現われるパターンを
<B>ping</B>

の
-<B>p</B>

オプションを使ってテストできる。
<A NAME="lbAH">&nbsp;</A>
<H2>TTL の詳細</H2>

IP パケットの
<B>TTL</B>

という値は、パケットが破棄される前に通過することができる
IP ルータの最大値を示す。
現在の慣例から、インターネットの各ルータは
<B>TTL</B>

フィールドを正確に 1 減らすことを期待できる。
<P>

<B>TCP/IP</B>

規格は、
<B>TCP</B>

パケットの
<B>TTL</B>

フィールドは 60 に設定されるべきであるとしているが、多くのシステムは
もっと小さな値を使用している (4.3
<B>BSD</B>

は 30、4.2 は 15)。
<P>

このフィールドの設定可能な最大値は 255 で、殆んどの Unix システムは
<B>ICMP ECHO_REQUEST</B>

の
<B>TTL</B>

フィールドを 255 に設定している。
これは、あるホストでは ``ping'' が通るのに、
<A HREF="../man1/telnet.1.html">telnet</A>(1)


や
<A HREF="../man1/ftp.1.html">ftp</A>(1)


ではそのホストに届かない理由 (の一つ) である。
<P>

ping の通常の操作では、受け取ったパケットの ttl の値が表示される。
リモートのシステムが ping パケットを受け取った時、その応答における
<B>TTL</B>

フィールドには以下の 3 つのうちの 1 つを取ることができる。
<UL><P>

<LI>

変更しない; これは
BSD 4.3 tahoe
リリース以前の BSD Unix システムが行っていたものである。
この場合、受け取ったパケットの
<B>TTL</B>

の値は、255 から往復経路上のルータの数を引いたものになる。
<LI>

255 にセットする; これは現在の BSD Unix が行っているものである。
(訳注: Linux もこれにあたる)。
この場合、受け取るパケットの
<B>TTL</B>

の値は、リモートシステム
から


<B>ping</B>

を行ったホストへの経路上のルータの数を、255 から引いたものである。
<LI>

その他の値にセットする。いくつかのマシンは、例えば 30 または 60 のような
<B>TCP</B>

パケットの値と同じものを
<B>ICMP</B>

パケットに用いる。また全く異なる値を用いるマシンもあるかも知れない。
</UL><P>

<A NAME="lbAI">&nbsp;</A>
<H2>バグ</H2>

多くのホストとゲートウェイは
<B>RECORD_ROUTE</B>

オプションを無視する。
<P>

<B>RECORD_ROUTE</B>

を完全に有効にするには、IP ヘッダの最大長は短過ぎる。
しかし、これについてできることは多くない。
<P>

flood ping は一般的には推奨されないし、ブロードキャストアドレスへの
flood ping は、きちんと条件を整えた場合においてのみ使用されるべきである。
<P>

日本語訳に際し、いくつかのオプションに関する記述を加えたが、正しいかど
うか分からない。
<A NAME="lbAJ">&nbsp;</A>
<H2>関連項目</H2>

netstat(1),


<A HREF="../../net-tools/man8/ifconfig.8.html">ifconfig</A>(8)


<A NAME="lbAK">&nbsp;</A>
<H2>履歴</H2>

<B></B>


コマンドは
BSD 4.3
から登場した。
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">名前</A><DD>
<DT><A HREF="#lbAC">書式</A><DD>
<DT><A HREF="#lbAD">説明</A><DD>
<DT><A HREF="#lbAE">ICMP パケットの詳細</A><DD>
<DT><A HREF="#lbAF">重複パケットと障害パケット</A><DD>
<DT><A HREF="#lbAG">異なるデータパターンの試行</A><DD>
<DT><A HREF="#lbAH">TTL の詳細</A><DD>
<DT><A HREF="#lbAI">バグ</A><DD>
<DT><A HREF="#lbAJ">関連項目</A><DD>
<DT><A HREF="#lbAK">履歴</A><DD>
</DL>
<HR>
This document was created by
<A HREF="../../man/man1/man2html.1.html">man2html</A>,
using the manual pages.<BR>
Time: 03:33:41 GMT, December 05, 2022
</BODY>
</HTML>
